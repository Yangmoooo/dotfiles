# ==========================
# 基础设置
# ==========================

# 将前缀键修改为 ctrl + s
set -g prefix C-s
unbind C-b
bind C-s send-prefix

# 重新加载配置文件 (prefix + r)
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display "Tmux config reload!"

# 开启鼠标支持
set -g mouse on

# 终端色彩修正
set -ag terminal-overrides ",xterm-256color:RGB"

# 窗口和面板从 1 开始编号
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
# 关掉某个窗口后，自动重新编号
set-option -g renumber-windows on

# ==========================
# 面板与窗口管理
# ==========================

# 分屏 - 代表横向，| 代表纵向，并且保持在当前路径
unbind '"'
bind - split-window -v -c "#{pane_current_path}"
unbind %
bind | split-window -h -c "#{pane_current_path}"

# 新窗口也保持当前路径
bind c new-window -c "#{pane_current_path}"

# 使用 h/j/k/l 在面板间切换
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# 调整面板大小 (prefix + H/J/K/L)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ==========================
# 复制模式
# ==========================

# 启用 vi 键位
setw -g mode-keys vi

# 绑定 v 进入选择模式，y 复制
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle # 块选择

# ==========================
# 插件管理
# ==========================

# 安装插件 prefix + I
# 更新插件 prefix + U
# 卸载插件 prefix + alt-u
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-sensible'

# 会话保存 prefix + ctrl-s
# 会话恢复 prefix + ctrl-r
set -g @plugin 'tmux-plugins/tmux-resurrect'

# 复制当前命令行输入到剪切板 prefix + y
# 复制当前路径到剪切板 prefix + Y
# 复制模式下（prefix + [）按 y 会复制选中的高亮文本到剪切板并退出复制模式
set -g @plugin 'tmux-plugins/tmux-yank'

# 复制标记的内容到剪切板 prefix + F
# 按 shift 再选择会直接粘贴到命令行
set -g @plugin 'Morantron/tmux-fingers'

set -g @plugin 'dracula/tmux'
set -g @dracula-plugins "cpu-usage ram-usage"
set -g @dracula-show-left-icon "#S"

# 覆盖 resurrect 配置
# 会话保存 prefix + S
# 会话恢复 prefix + R
set -g @resurrect-save 'S'
set -g @resurrect-restore 'R'

run '~/.tmux/plugins/tpm/tpm'
