# ==========================
# 基础设置
# ==========================

# 将前缀键修改为 ctrl + s
set -g prefix C-s
unbind C-b
bind C-s send-prefix

# 重新加载配置文件 (prefix + r)
unbind r
bind r source-file ~/.tmux.conf \; display "tmux config reload!"

# 开启鼠标支持
set -g mouse on

# 终端色彩修正
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# 历史记录行数
set -g history-limit 50000

# 窗口和面板从 1 开始编号
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on  # 关掉某个窗口后，自动重新编号

# 消除 vim 按 esc 的延迟
set -s escape-time 0

# ==========================
# 面板与窗口管理
# ==========================

# 分屏 - 代表横向，| 代表纵向，并且保持在当前路径
unbind '"'
bind - split-window -v -c "#{pane_current_path}"
unbind %
bind | split-window -h -c "#{pane_current_path}"

# 新窗口也保持当前路径
bind c new-window -c "#{pane_current_path}"

# 使用 h/j/k/l 在面板间切换
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# 调整面板大小 (prefix + H/J/K/L)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ==========================
# 复制模式
# ==========================

# 启用 vi 键位
setw -g mode-keys vi

# 绑定 v 进入选择模式，y 复制
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle # 块选择

# ==========================
# 状态栏美化
# ==========================

set-option -g status-position bottom
set -g status-left-length 50
set -g status-left "#[fg=green,bold] #S #[fg=white]| "
set -g status-right "#[fg=cyan]%H:%M #[fg=yellow]%d-%b"
set -g status-style bg=default,fg=white

# ==========================
# 插件管理
# ==========================

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-yank'

run '~/.tmux/plugins/tpm/tpm'
